# フロントエンド改良仕様 - 要件定義書

## はじめに

HOSHUTAROアプリケーションのフロントエンド改良により、**既存の星取表機能を保持しながら**、現在のUIをより洗練されたモダンなデザインに刷新し、Excelライクな直感的な操作性を実現します。ミニマルでモダンなデザインを採用し、ユーザビリティを大幅に向上させることを目標とします。

## 既存機能の保持

以下の既存機能は必ず保持し、改良版でも同様に動作する必要があります：

- 星取表の基本表示・編集機能
- 3レベル階層フィルタリング（階層レベル1/2/3）
- 機器名検索機能
- 表示モード切り替え（星取表示 ⇔ コスト表示）
- 時間スケール切り替え（年/月/週/日）
- 年度操作（追加・削除）
- データ操作（エクスポート・インポート・初期化）
- 表示設定（TAG No.・周期の表示切り替え）
- 階層グループ表示機能
- **機器仕様管理機能**（specifications: 機器名称、型式等の詳細情報）

## 新規追加機能

以下の機能を新たに追加します：

- **表示エリア切り替え機能**：機器仕様と計画実績の表示を切り替え、または両方を横スクロールで表示
- **機器仕様編集機能**：機器名称、型式等の仕様情報のインライン編集
- **分割表示機能**：機器リスト固定、機器仕様・計画実績エリアの独立スクロール

## 要件

### 要件1: API Gateway統合とデータ管理の改善

**ユーザーストーリー:** システム管理者として、設備データをクラウドで一元管理し、リアルタイムでデータの同期を行いたい

#### 受入基準

1. WHEN ユーザーがアプリケーションを起動する THEN システムはAPI Gateway経由でバックエンドから最新の設備データを取得する SHALL
2. WHEN ユーザーが設備データを編集する THEN システムはリアルタイムでAPI Gateway経由でデータを保存する SHALL  
3. IF ネットワーク接続が不安定な場合 THEN システムはオフライン機能を提供し、接続復旧時に自動同期する SHALL
4. WHEN データの競合が発生する THEN システムは適切な競合解決メカニズムを提供する SHALL

### 要件2: Bedrock Agent統合による AI アシスタント機能とExcelインポート

**ユーザーストーリー:** 保全担当者として、AI アシスタントに設備の保全計画や故障予測について相談し、Excelファイルのインポートも AI の支援を受けて効率的に行いたい

#### 受入基準

1. WHEN ユーザーがAIアシスタント機能を起動する THEN システムはBedrock Agent APIに接続する SHALL
2. WHEN ユーザーが設備に関する質問を入力する THEN AIアシスタントは適切な回答を提供する SHALL
3. WHEN AIが保全推奨事項を提案する THEN システムは提案内容を星取表に反映するオプションを提供する SHALL
4. WHEN ユーザーがExcelファイルをAIアシスタントにアップロードする THEN AIはファイル内容を解析し、データマッピングを自動提案する SHALL
5. WHEN AIがExcelデータを解析する THEN システムは設備情報の整合性チェックと重複検出を自動実行する SHALL
6. WHEN AIがインポート結果を提示する THEN システムは推奨される修正内容と理由を分かりやすく説明する SHALL
7. IF AIアシスタントが利用できない場合 THEN システムは代替手段またはエラーメッセージを表示する SHALL
8. IF Excelファイルに問題がある場合 THEN AIは具体的な修正方法と代替案を提案する SHALL

### 要件3: 既存星取表のExcelライク操作性向上と表示エリア管理

**ユーザーストーリー:** データ入力担当者として、既存の星取表でExcelと同様の直感的な操作でセルの編集、コピー、ペースト、キーボードナビゲーション、列幅調整を行い、機器仕様と計画実績を効率的に表示・編集したい

#### 受入基準

1. WHEN ユーザーが既存の星取表のセルをクリックする THEN システムは即座にインライン編集モードに切り替わる SHALL
2. WHEN ユーザーがTabキーを押す THEN システムは次のセルに自動的にフォーカスを移動する SHALL
3. WHEN ユーザーがEnterキーを押す THEN システムは下のセルに自動的にフォーカスを移動する SHALL
4. WHEN ユーザーがCtrl+Cでコピーする THEN システムは選択されたセルの内容をクリップボードに保存する SHALL
5. WHEN ユーザーがCtrl+Vでペーストする THEN システムはクリップボードの内容を対象セルに貼り付ける SHALL
6. WHEN ユーザーが矢印キーを使用する THEN システムは対応する方向のセルにフォーカスを移動する SHALL
7. WHEN ユーザーが列境界をドラッグする THEN システムは列幅をリアルタイムで調整する SHALL
8. WHEN ユーザーが行境界をドラッグする THEN システムは行高をリアルタイムで調整する SHALL
9. WHEN ユーザーが列ヘッダーをダブルクリックする THEN システムは内容に応じて列幅を自動調整する SHALL
10. IF セルの編集中にEscキーが押される THEN システムは編集をキャンセルし、元の値に戻す SHALL
11. WHEN 既存の階層フィルタリング機能を使用する THEN システムは新しいExcel操作性と組み合わせて動作する SHALL
12. WHEN 既存の表示モード切り替えを使用する THEN システムは星取表示とコスト表示の両方でExcel操作性を提供する SHALL
13. WHEN 機器仕様情報（specifications）を表示・編集する THEN システムは既存の仕様管理機能を保持しながらExcel操作性を提供する SHALL
14. WHEN ユーザーが表示エリア切り替えボタンを操作する THEN システムは「機器仕様のみ」「計画実績のみ」「両方表示」のモードを切り替える SHALL
15. WHEN 両方表示モードを選択する THEN システムは機器リストを固定し、機器仕様エリアと計画実績エリアを横スクロールで表示する SHALL
16. WHEN 機器仕様エリアで編集を行う THEN システムは機器名称、型式等の仕様情報をリアルタイムで更新する SHALL
17. WHEN 計画実績エリアで編集を行う THEN システムは既存の星取表機能と同様に動作する SHALL

### 要件4: 既存機能統合型モダンヘッダーデザイン

**ユーザーストーリー:** ユーザーとして、既存の全機能にアクセスできるモダンなヘッダーメニューで効率的にアプリケーション機能を使いたい

#### 受入基準

1. WHEN ユーザーがアプリケーションを表示する THEN ヘッダーはミニマルなデザインで既存の全機能にアクセス可能な要素を表示する SHALL
2. WHEN ユーザーがメニューアイコンにホバーする THEN システムは適切なツールチップを表示する SHALL
3. WHEN ユーザーがドロップダウンメニューを開く THEN システムはスムーズなアニメーションで展開する SHALL
4. WHEN 画面幅が狭くなる THEN システムはハンバーガーメニューに自動的に切り替わる SHALL
5. WHEN 既存の検索・フィルタリング・表示設定機能を使用する THEN システムはモダンなヘッダー内で統合された形で提供する SHALL
6. WHEN 既存のデータ操作機能を使用する THEN システムはヘッダーメニューから直感的にアクセス可能にする SHALL
7. IF メニュー項目が多い場合 THEN システムは適切なグループ化とアイコンで視認性を向上させる SHALL

### 要件5: 全体的なモダンデザインシステムの実装

**ユーザーストーリー:** ユーザーとして、一貫性のあるモダンなデザインで快適にアプリケーションを使用したい

#### 受入基準

1. WHEN ユーザーがアプリケーションを使用する THEN システムは統一されたカラーパレットとタイポグラフィを適用する SHALL
2. WHEN ユーザーがボタンやリンクを操作する THEN システムは適切なホバー効果とフィードバックを提供する SHALL
3. WHEN データが読み込まれる THEN システムはエレガントなローディングアニメーションを表示する SHALL
4. WHEN エラーが発生する THEN システムは分かりやすいエラーメッセージとアイコンを表示する SHALL
5. IF ダークモードが選択される THEN システムは適切なダークテーマを適用する SHALL

### 要件6: レスポンシブデザインとモバイル最適化

**ユーザーストーリー:** 現場作業者として、タブレットやスマートフォンでも快適に星取表を操作したい

#### 受入基準

1. WHEN ユーザーがタブレットでアクセスする THEN システムはタッチ操作に最適化されたUIを提供する SHALL
2. WHEN 画面サイズが変更される THEN システムは自動的にレイアウトを調整し、重要な情報を優先表示する SHALL
3. WHEN モバイルデバイスで表示する THEN システムは横スクロール可能な表形式を提供する SHALL
4. IF 画面が小さい場合 THEN システムは重要な列のみを表示し、詳細は展開可能にする SHALL

### 要件7: 高度なフィルタリングと検索機能

**ユーザーストーリー:** データ分析担当者として、複数の条件を組み合わせて効率的に設備データを絞り込みたい

#### 受入基準

1. WHEN ユーザーが検索ボックスに入力する THEN システムはリアルタイムで結果をフィルタリングする SHALL
2. WHEN ユーザーが複数のフィルター条件を設定する THEN システムはAND/OR条件で組み合わせ検索を実行する SHALL
3. WHEN ユーザーが保存済みフィルターを選択する THEN システムは即座に条件を適用する SHALL
4. IF 検索結果が0件の場合 THEN システムは代替検索候補を提案する SHALL

### 要件8: パフォーマンス最適化と仮想化

**ユーザーストーリー:** 大量データを扱うユーザーとして、スムーズなスクロールと高速な表示でストレスなく作業したい

#### 受入基準

1. WHEN 大量のデータを表示する THEN システムは仮想スクロールで高速レンダリングを実現する SHALL
2. WHEN ユーザーがスクロールする THEN システムは60FPSでスムーズなスクロール体験を提供する SHALL
3. WHEN データが更新される THEN システムは必要な部分のみを再レンダリングする SHALL
4. IF メモリ使用量が多い場合 THEN システムは適切なガベージコレクションとメモリ管理を実行する SHALL